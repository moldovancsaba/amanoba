# P2 Status: Onboarding Survey / Email Automation / Multi-Format Forking

**Date**: 2026-01-28  
**Scope**: ROADMAP Â§ Onboarding Survey, Email Automation, Multi-Format Course Forking

---

## Onboarding Survey & Segmentation â€” IMPLEMENTED

**Status**: âœ… Core implemented

- **Survey model** (`app/lib/models/survey.ts`): Question types, brandId, questions array, metadata.
- **SurveyResponse model** (`app/lib/models/survey-response.ts`): Player/survey/answers, completedAt, metadata.
- **API** `GET/POST /api/surveys/onboarding`: Get questions, submit responses; updates Player (`surveyCompleted`, `skillLevel`, `interests`).
- **Page** `app/[locale]/onboarding/page.tsx`: Multi-step form, single/multiple choice and rating, progress, validation.
- **Player fields**: `surveyCompleted`, `skillLevel`, `interests` (used by recommendations).
- **Course recommendations** `GET /api/courses/recommendations`: Uses `player.surveyCompleted`, `skillLevel`, `interests`; returns personalized list.
- **Admin** `app/[locale]/admin/surveys/page.tsx`: Survey management.
- **Seed**: `npm run seed:survey` (scripts/seed-onboarding-survey.ts).

**Remaining (optional)**:
- Admin survey analytics dashboard (response counts, segmentation view).
- Redirect after survey completion to dashboard with `?surveyCompleted=true` (currently commented out).
- Replace `alert()` with toast on submit (e.g. sonner).

---

## Email Automation Enhancement â€” PHASE 1 (UPSELL) DONE

**Status**: âœ… Phase 1 upsell implemented (2026-01-31)

- **Completion email upsell**: `sendCompletionEmail` now fetches up to 3 recommended courses (via `getCourseRecommendations`) and appends a "Recommended for you" section with links to each course. The completed course is excluded. Uses player `skillLevel` and `interests` when available.
- **Shared lib** `app/lib/course-recommendations.ts`: `getCourseRecommendations(player, limit, locale?, excludeCourseId?)` â€” used by `GET /api/courses/recommendations` and by the completion email.
- **Localized upsell heading**: `completionUpsellHeading` added for all locales (en, hu, ar, hi, id, pt, vi, tr, bg, pl, ru) in `email-localization.ts`.

**Remaining Phase 1 (optional)**: Segment-specific email templates (tone by skill level), open/click tracking. Phase 2: MailerLite/ActiveCampaign, drip campaigns, A/B testing. See ROADMAP Â§ Email Automation Enhancement.

---

## Multi-Format Course Forking â€” PLANNED

**Status**: ðŸŸ¡ ROADMAP

- Handover/plan: `docs/2026-01-27_RAPID_CHILDREN_COURSES_ACTION_PLAN_AND_HANDOVER.md`, `docs/2026-01-27_RAPID_CHILDREN_COURSES_DELIVERY_PLAN.md`.
- Scope: Fork 30-day â†’ 7d / weekend / 1d / 1h; lesson mapping, quiz strategy, sync, certificate with limited questions.

---

## Summary

| Item                    | Status   | Notes                                                                 |
|-------------------------|----------|-----------------------------------------------------------------------|
| Onboarding survey       | Done     | API, page, models, recommendations, admin                            |
| Email automation (Phase 1 upsell) | Done | Completion email recommends 3 courses; shared course-recommendations lib |
| Email automation (rest) | Optional | Segment templates, open/click tracking; Phase 2: MailerLite/ActiveCampaign |
| Multi-format forking   | Planned  | See handover and delivery plan docs                                   |
