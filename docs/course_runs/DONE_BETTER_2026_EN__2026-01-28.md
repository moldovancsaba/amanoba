# Run Log — DONE_BETTER_2026_EN — Initial Course Seed

- Created: 2026-01-28
- Course: DONE_BETTER_2026_EN
- Course name: Done is better - Build What Matters
- Language: en
- CCS: docs/canonical/DONE_BETTER_2026/DONE_BETTER_2026.canonical.json
- CCS narrative: docs/canonical/DONE_BETTER_2026/DONE_BETTER_2026_CCS.md

## What Was Done

1. **Canonical Course Spec (CCS)**  
   - `docs/canonical/DONE_BETTER_2026/DONE_BETTER_2026.canonical.json`: language-neutral spec with intent, concepts, procedures, 30 lessons, assessment blueprint, bibliography.  
   - `docs/canonical/DONE_BETTER_2026/DONE_BETTER_2026_CCS.md`: narrative (quiz gates, localization, rollback).

2. **Seed script**  
   - `scripts/seed-done-better-2026-en.ts`: creates/updates **CCS document** (DONE_BETTER_2026) in the DB so it appears under "Course families" in admin; creates/updates course and 30 lessons; optionally seeds quizzes (≥7 questions/lesson, 0 RECALL, ≥5 APPLICATION, ≥2 CRITICAL_THINKING).

3. **Course run doc**  
   - This file: run log and safety rollback.

## Critical: Seed must use the same database as the app (dbName)

- The **Next.js app** (and admin API) connects to MongoDB with **`dbName: process.env.DB_NAME || 'amanoba'`** (see `app/lib/mongodb.ts`). All app data (CCS, Course, Lesson, QuizQuestion) lives in the **amanoba** database.
- **Seed scripts must pass the same `dbName`** when connecting. Otherwise they write to the default database (e.g. **test** when the URI has no path), and the app will not see the data.
- **Bug (fixed):** The initial `seed-done-better-2026-en.ts` and `verify-done-better-2026-seed.ts` used `mongoose.connect(process.env.MONGODB_URI!)` with no options, so they wrote to the wrong database. They now use `dbName: process.env.DB_NAME || 'amanoba'`, matching `seed-playbook-design-2026-en.ts` and `seed-b2b-sales-masterclass-en.ts`.
- **After the fix:** Re-run the seed so CCS, course, lessons, and quizzes are written to the **amanoba** database; then they will appear on amanoba.com/admin/courses.

## How to Run the Seed

- **Dry-run (no DB writes):**  
  `npx tsx --env-file=.env.local scripts/seed-done-better-2026-en.ts`

- **Apply (create/update course + lessons):**  
  `npx tsx --env-file=.env.local scripts/seed-done-better-2026-en.ts --apply`

- **Apply including quizzes:**  
  `npx tsx --env-file=.env.local scripts/seed-done-better-2026-en.ts --apply --include-quizzes`

- **Update existing lessons (overwrite content):**  
  `npx tsx --env-file=.env.local scripts/seed-done-better-2026-en.ts --apply --update-existing-lessons`

## Safety Rollback Plan

### If DB was applied and you need to undo

- **Option A — Revert data manually:**  
  Delete or deactivate the course/lessons in the DB (e.g. set `isActive: false` on the course), and remove quiz questions for `lessonId` matching `DONE_BETTER_2026_EN_DAY_*`. No automated script is provided; use admin or a one-off script.

- **Option B — Restore from backup:**  
  If you created a DB backup before running the seed, restore that backup. Document backup location and restore command in your run.

### If you need to roll back code/docs only

- Uncommitted changes:  
  `git checkout -- docs/canonical/DONE_BETTER_2026 scripts/seed-done-better-2026-en.ts docs/course_runs/DONE_BETTER_2026_EN__2026-01-28.md`

- Committed changes:  
  `git revert <commit_sha>` (or revert the specific commits that added the CCS, seed script, and this run log).

## Quiz Quality Gates (from CCS)

- 0 RECALL questions.
- Minimum 7 valid questions per lesson.
- Minimum 5 APPLICATION and 2 CRITICAL_THINKING per lesson.
- Standalone, educational options; no lesson-referential wording; no throwaway distractors.

## Quiz Quality Fix (54 → 0 invalid) — 2026-01-28

- **Issue:** Global audit reported 54 invalid questions (short questions &lt;40 chars, short options &lt;25 chars, generic patterns).
- **Approach:** All fixes in `scripts/seed-done-better-2026-en.ts`: scenario-based rewrites and educational option lengthening (no padding; quality over quality).
- **Seed (apply + quizzes):**  
  `npx tsx --env-file=.env.local scripts/seed-done-better-2026-en.ts --apply --include-quizzes`
- **Verification:**  
  `npx tsx --env-file=.env.local scripts/audit-ccs-global-quality.ts --course DONE_BETTER_2026_EN --min-lesson-score 70`
- **Result:** invalidQuestions: 0, lessonsWithQuizErrors: 0, lessonsBelowQualityThreshold: 0.
- **Report:** `scripts/reports/ccs-global-audit__2026-01-28T23-06-48-113Z.json`  
- **Tasklist:** `docs/tasklists/CCS_GLOBAL_AUDIT__2026-01-28T23-06-48-113Z.md`

## Notes

- Brand: script uses `Brand` with `slug: 'amanoba'` (creates if missing).
- Course `brandId` is required; `ccsId` is set to `DONE_BETTER_2026`.
- Before first apply, run dry-run and confirm `.env.local` and `MONGODB_URI` are correct.
