# Course Run Log — PRODUCTIVITY_2026_HU (Production)

- Course: `PRODUCTIVITY_2026_HU`
- Environment: **production** (`.env.local`)
- Started (UTC): `2026-01-27T10:55:27Z`
- Mode: **dry-run first** (no DB writes until explicit confirmation)

## Safety Rollback Plan (Mandatory)

This run will not write to DB until apply is explicitly approved.

If/when apply is approved:

- Quiz rollback (per lesson backup restore):
  - `npx tsx --env-file=.env.local scripts/restore-lesson-quiz-from-backup.ts --file scripts/quiz-backups/PRODUCTIVITY_2026_HU/<LESSON_ID__TIMESTAMP>.json`
- Lesson rollback (only if we refine lesson content):
  - `npx tsx --env-file=.env.local scripts/restore-lesson-from-backup.ts --file scripts/lesson-backups/PRODUCTIVITY_2026_HU/<LESSON_ID__TIMESTAMP>.json`

## Commands (Planned)

1) Lesson audit:
   - `npx tsx --env-file=.env.local scripts/audit-lesson-quality.ts --course PRODUCTIVITY_2026_HU --min-score 70`
2) Pipeline dry-run:
   - `npx tsx --env-file=.env.local scripts/quiz-quality-pipeline.ts --course PRODUCTIVITY_2026_HU --min-lesson-score 70 --dry-run`

## Outputs

- Lesson audit:
  - `scripts/reports/lesson-quality-audit__2026-01-27T10-55-47-613Z.json`
  - `scripts/reports/lesson-refine-tasks__2026-01-27T10-55-47-613Z.md`
- Pipeline dry-run:
  - `scripts/reports/quiz-quality-pipeline__2026-01-27T10-55-57-632Z.json`
  - `scripts/reports/quiz-quality-pipeline__2026-01-27T10-55-57-632Z__lesson-refine-tasks.md`
  - `scripts/reports/quiz-quality-pipeline__2026-01-27T10-55-57-632Z__rewrite-failures.md`
- Backups created (dry-run artifacts written to disk):
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_01__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_02__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_03__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_04__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_05__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_06__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_08__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_09__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_10__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_12__2026-01-27T10-55-57-632Z.json`
  - `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_13__2026-01-27T10-55-57-632Z.json`
- Generator sample (not DB-written):
  - `scripts/reports/sample-quiz__PRODUCTIVITY_2026_HU__DAY_01__2026-01-27T10-57-12-808Z.json`

## Summary (Dry-Run)

- Lessons evaluated: **30**
- Lessons needing refinement (score < 70): **19** (Days **7, 11, 14–30**)
- Lessons eligible for quiz work (score >= 70): **11** (Days **1–6, 8–10, 12–13**)
- Rewrite failures under strict QC: **0** (dry-run)
- DB writes: **none** (`questionsDeleted=0`, `questionsInserted=0`)

## Notes / Findings

- Current HU generator can still output disallowed patterns (title-references + throwaway options). Example captured in:
  - `scripts/reports/sample-quiz__PRODUCTIVITY_2026_HU__DAY_01__2026-01-27T10-57-12-808Z.json`
- Generator fix applied (code-only, no DB writes):
  - `scripts/content-based-question-generator.ts` — HU templates updated to remove title crutches + remove throwaway options and make options educational/long enough.
- Updated sample after generator fix:
  - `scripts/reports/sample-quiz__PRODUCTIVITY_2026_HU__DAY_01__2026-01-27T11-00-01-939Z.json`
- Re-run pipeline dry-run after generator fix:
  - `scripts/reports/quiz-quality-pipeline__2026-01-27T11-00-14-390Z.json`
  - `scripts/reports/quiz-quality-pipeline__2026-01-27T11-00-14-390Z__lesson-refine-tasks.md`
  - `scripts/reports/quiz-quality-pipeline__2026-01-27T11-00-14-390Z__rewrite-failures.md`
- Mongoose emits duplicate index warnings (known tech debt; not part of this run).

## Apply Run (Production)

Command:
- `npx tsx --env-file=.env.local scripts/quiz-quality-pipeline.ts --course PRODUCTIVITY_2026_HU --min-lesson-score 70`

Outputs:
- `scripts/reports/quiz-quality-pipeline__2026-01-27T11-04-20-394Z.json`
- `scripts/reports/quiz-quality-pipeline__2026-01-27T11-04-20-394Z__lesson-refine-tasks.md`
- `scripts/reports/quiz-quality-pipeline__2026-01-27T11-04-20-394Z__rewrite-failures.md`

Backups created:
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_01__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_02__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_03__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_04__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_05__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_06__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_08__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_09__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_10__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_12__2026-01-27T11-04-20-394Z.json`
- `scripts/quiz-backups/PRODUCTIVITY_2026_HU/PRODUCTIVITY_2026_HU_DAY_13__2026-01-27T11-04-20-394Z.json`

DB writes summary:
- Deleted: **14**
- Inserted: **48**

## Post-Apply Verification

- `scripts/reports/post-apply-summary__PRODUCTIVITY_2026_HU__2026-01-27T11-05-18-725Z.json`
- Eligible lessons now pass strict QC: Days **1–6, 8–10, 12–13** (>=7 total, >=5 application, 0 recall)
- Remaining blocked by lesson quality (<70): Days **7, 11, 14–30**

Post-apply sample (from DB):
- `scripts/reports/sample-quiz__PRODUCTIVITY_2026_HU__DAY_01__POST_APPLY__2026-01-27T11-05-40-635Z.json`

## Next Phase — Lesson Refinement (Dry-Run Preview)

Goal: raise lesson quality scores for blocked days so quiz pipeline can run at strict QC.

Command (dry-run):
- `npx tsx --env-file=.env.local scripts/refine-productivity-2026-hu-lessons.ts --course PRODUCTIVITY_2026_HU --from-day 7 --to-day 30`

Output:
- `scripts/reports/lesson-refine-preview__PRODUCTIVITY_2026_HU__2026-01-27T11-20-14-496Z.json`

Preview summary:
- Considered lessons: **19** (Days **7, 11, 14–30**)
- Eligible after refinement (score >= 70): **19**
- Dry-run only: **no DB writes** yet

## Lesson Refinement Apply (Production)

Command:
- `npx tsx --env-file=.env.local scripts/refine-productivity-2026-hu-lessons.ts --course PRODUCTIVITY_2026_HU --from-day 7 --to-day 30 --apply`

Output:
- `scripts/reports/lesson-refine-preview__PRODUCTIVITY_2026_HU__2026-01-27T11-23-08-362Z.json`

Backups created:
- `scripts/lesson-backups/PRODUCTIVITY_2026_HU/` (19 per-lesson backups, timestamp `2026-01-27T11-23-08-362Z`)

## Quiz Pipeline After Lesson Refinement

Dry-run:
- `scripts/reports/quiz-quality-pipeline__2026-01-27T11-23-21-018Z.json`

Apply:
- `scripts/reports/quiz-quality-pipeline__2026-01-27T11-23-36-072Z.json` (inserted **130**, deleted **0**)

## Final Verification

- `scripts/reports/post-apply-summary__PRODUCTIVITY_2026_HU__2026-01-27T11-24-09-555Z.json`
- Result: **30/30 lessons pass** (>=7 total, >=5 application, 0 recall)

Post-apply sample (from DB, Day 30):
- `scripts/reports/sample-quiz__PRODUCTIVITY_2026_HU__DAY_30__POST_APPLY__2026-01-27T11-24-30-934Z.json`

## Process State

- Status: **COMPLETE**
- Next: pick next course/language and repeat
